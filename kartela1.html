<!DOCTYPE html>
<html lang="eu">
<head>
<meta charset="UTF-8">
<title>Larraun â€“ Kartel Inprimagarria</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>

/* ================= BASE ================= */

body{
  margin:0;
  font-family:"Trebuchet MS","Arial Black",system-ui,sans-serif;
  background:#1b4d31;
}

button{
  background:#0d47a1;
  color:#fff;
  border:none;
  padding:10px 18px;
  border-radius:20px;
  cursor:pointer;
}

/* ================= PAGINA A4 ================= */

.pagina{
  width:900px;
  height:1400px;
  margin:20px auto;
  position:relative;
  overflow:hidden;
  background:#2a623f;
  box-shadow:0 10px 30px rgba(0,0,0,.5);
}

/* ================= PELOTAZOS ================= */

.pelotazos{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:0;
}

.pelota{
  position:absolute;
  border-radius:50%;
  background:#000;
}

/* ================= CABECERA FRONTÃ“N ================= */

.header{
  position:relative;
  z-index:2;
}

.colchon-azul{
  background:#3949ab;
  padding:16px 22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:
    inset 0 8px 12px rgba(255,255,255,.35),
    inset 0 -10px 12px rgba(0,0,0,.55);
}

.colchon-azul h1{
  color:#fff;
  letter-spacing:3px;
  font-size:26px;
}

.chapa{
  height:10px;
  background:#000;
}

/* ================= CONTENIDO ================= */

.contenido{
  position:relative;
  z-index:2;
  padding:20px;
}

/* ================= BLOQUES ================= */

.bloque{margin-top:26px}
.bloque h2{
  text-align:center;
  color:#fff;
}

/* ================= GRUPOS ================= */

.grupo{
  background:#fff;
  border-radius:10px;
  margin-top:10px;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
}

.grupo-header{
  padding:10px;
  font-weight:bold;
  color:#fff;
  background:#0d47a1;
  box-shadow:
    inset 0 6px 8px rgba(255,255,255,.3),
    inset 0 -8px 10px rgba(0,0,0,.45);
}

.grupo-header.rojo{
  background:#b00000;
}

.linea{
  display:flex;
  gap:10px;
  padding:8px 12px;
  border-top:1px solid #ddd;
  font-weight:900;
  text-shadow:0 1px 0 #fff,0 2px 2px rgba(0,0,0,.3);
}

.zkia{width:26px}
.etxekoa{color:#0d47a1}
.kanpokoa{color:#b71c1c}
.lehiaketa{margin-left:auto;text-align:right}
.fase{font-weight:900}

/* ================= PIE FRONTÃ“N ================= */

.footer{
  position:absolute;
  bottom:0;
  width:100%;
}

.colchon-gris{
  background:#2c2c2c;
  padding:12px;
}

.suelo{
  background:#9e9e9e;
  padding:20px 10px 30px;
}

.logos-grid{
  display:grid;
  grid-template-columns:repeat(10,1fr);
  gap:8px;
}

.logo-item{
  background:#fff;
  padding:4px;
  border-radius:6px;
}

.logo-item img{
  width:100%;
  height:34px;
  object-fit:contain;
}

.exportar{
  text-align:center;
  margin:16px;
}

</style>
</head>

<body>

<div class="exportar">
<button onclick="exportarPaginas()">ðŸ“¸ DESKARGATU KARTELAK</button>
</div>

<div id="paginas"></div>

<script>

/* ================= PELOTAZOS ================= */

function generarPelotazos(pagina){

  const cont = pagina.querySelector(".pelotazos");
  const w = 900;
  const h = 1400;

  for(let i=0;i<2000;i++){

    const d=document.createElement("div");
    d.className="pelota";

    const r=Math.random();

    let size;
    if(r<0.6) size=Math.random()*3+2;
    else if(r<0.9) size=Math.random()*5+4;
    else size=Math.random()*10+8;

    d.style.width=d.style.height=size+"px";
    d.style.left=Math.random()*w+"px";
    d.style.top=Math.random()*h+"px";
    d.style.opacity=Math.random()*0.08+0.04;

    cont.appendChild(d);
  }
}

/* ================= CREAR PÃGINA ================= */

function crearPagina(){

  const pagina=document.createElement("div");
  pagina.className="pagina";

  pagina.innerHTML=`
  <div class="pelotazos"></div>

  <div class="header">
    <div class="colchon-azul">
      <img src="/images/logo-larraun.png" height="60">
      <h1>LARRAUN PILOTA ELKARTEA</h1>
      <img src="/images/logo-fnp.png" height="60">
    </div>
    <div class="chapa"></div>
  </div>

  <div class="contenido"></div>

  <div class="footer">
    <div class="chapa"></div>
    <div class="colchon-gris"></div>
    <div class="suelo">
      <div class="logos-grid" id="logos"></div>
    </div>
  </div>
  `;

  document.getElementById("paginas").appendChild(pagina);

  generarPelotazos(pagina);

  return pagina;
}

/* ================= EXPORTAR MULTIPÃGINA ================= */

async function exportarPaginas(){

  const bloques=[...document.querySelectorAll(".bloque")];

  let pagina=null;
  let contenido=null;

  let contador=1;

  for(const bloque of bloques){

    if(!pagina){
      pagina=crearPagina();
      contenido=pagina.querySelector(".contenido");
    }

    const clon=bloque.cloneNode(true);
    contenido.appendChild(clon);

    if(pagina.scrollHeight>1400){
      contenido.removeChild(clon);
      await guardar(pagina,contador++);
      pagina=crearPagina();
      contenido=pagina.querySelector(".contenido");
      contenido.appendChild(clon);
    }
  }

  if(pagina) await guardar(pagina,contador);
}

/* ================= GUARDAR ================= */

async function guardar(pagina,n){

  await html2canvas(pagina,{scale:2,useCORS:true}).then(canvas=>{
    const a=document.createElement("a");
    a.download=`kartela_${n}.jpg`;
    a.href=canvas.toDataURL("image/jpeg",0.95);
    a.click();
  });
}

</script>

</body>
</html>
