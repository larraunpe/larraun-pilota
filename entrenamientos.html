<!DOCTYPE html>
<html lang="eu">
<head>
<meta charset="UTF-8">
<title>Entrenamenduak | Larraun Pilota Elkartea</title>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#f4f4f4;
  color:#222;
}

header{
  background:#004d40;
  color:#fff;
  padding:20px;
  text-align:center;
}

main{
  max-width:1200px;
  margin:auto;
  padding:30px 20px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:24px;
}

.card{
  background:#fff;
  border-radius:14px;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
  overflow:hidden;
}

.card h2{
  margin:0;
  padding:16px;
  color:#fff;
  font-size:1.2em;
}

.card .content{
  padding:16px;
}

/* ===== COLORES CABECERA ===== */
.esku-julen h2{background:#2e7d32;}
.esku-barriola h2{background:#1565c0;}
.pala h2{background:#6a1b9a;}

/* ===== GRUPOS ===== */
.group{
  margin-bottom:14px;
  border-radius:10px;
  padding:10px 12px;
}

.aurrebenjaminak{background:#f1e0c5;}
.benjaminak{background:#ffcc80;}
.alebinak{background:#fff59d;}
.infantilak{background:#a5d6a7;}
.kadeteak{background:#81d4fa;}
.jubenilak{background:#90caf9;}
.nagusiak{background:#90a4ae;}

.group h3{
  margin:0 0 6px;
  font-size:0.95em;
}

ul{
  margin:0;
  padding-left:18px;
}

li{
  font-size:0.9em;
  line-height:1.4;
  padding:3px 6px;
  border-radius:6px;
  margin-bottom:3px;
}
</style>
</head>

<body>

<header>
  <h1>ENTRENAMENDUAK</h1>
</header>

<main>

<div class="grid">

  <div class="card esku-julen">
    <h2>ü§æ Eskupilota ¬∑ Julen Martija</h2>
    <div class="content" id="esku-julen"></div>
  </div>

  <div class="card esku-barriola">
    <h2>ü§æ Eskupilota ¬∑ Abel Barriola + Enrike Galarza</h2>
    <div class="content" id="esku-barriola"></div>
  </div>

  <div class="card pala">
    <h2>üèì Pala</h2>
    <div class="content" id="pala"></div>
  </div>

</div>

</main>

<script>
/* ===== ORDEN FIJO DE CATEGOR√çAS ===== */
const ordenCategorias = [
  "Aurrebenjaminak",
  "Benjaminak",
  "Alebinak",
  "Infantilak",
  "Kadeteak",
  "Jubenilak",
  "Nagusiak"
];

/* ===== CONTENEDORES ===== */
const contenedores = {
  "ESKU PILOTA": {
    "AURREBENJAMINAK": "esku-julen",
    "BENJAMINAK": "esku-julen",
    "ALEBINAK": "esku-julen",
    "INFANTILAK": "esku-barriola",
    "KADETEAK": "esku-barriola",
    "JUBENILAK": "esku-barriola",
    "NAGUSIAK": "esku-barriola"
  },
  "PALA GOMA": {
    "*": "pala"
  }
};

function categoriaPorAnio(anio){
  if (anio >= 2018) return "Aurrebenjaminak";
  if (anio >= 2016) return "Benjaminak";
  if (anio >= 2014) return "Alebinak";
  if (anio >= 2012) return "Infantilak";
  if (anio >= 2010) return "Kadeteak";
  if (anio >= 2008) return "Jubenilak";
  return "Nagusiak";
}

function claseCategoria(cat){
  return cat.toLowerCase().replace(/\s+/g,"");
}

function normalizar(txt){
  return txt.toUpperCase().replace(/\s+[0-9AB]$/,"").trim();
}

/* ===== CARGA ===== */
fetch('/data/pelotariak.json')
.then(r => r.json())
.then(data => {

  const grupos = {};

  data.forEach(p => {
    const categoriaEdad = categoriaPorAnio(p.URTEA);
    const modalidad = normalizar(p.MODALITATEA);

    const key = modalidad + "|" + categoriaEdad;
    if (!grupos[key]) grupos[key] = [];
    grupos[key].push(p);
  });

  Object.entries(grupos).forEach(([key, pelotaris]) => {
    const [modalidad, categoria] = key.split("|");

    const contenedor =
      contenedores[modalidad]?.[categoria.toUpperCase()] ||
      contenedores[modalidad]?.["*"];

    if (!contenedor) return;

    const wrapper = document.createElement("div");
    wrapper.dataset.categoria = categoria;
    wrapper.className = "group " + claseCategoria(categoria);

    const h3 = document.createElement("h3");
    h3.textContent = categoria;
    wrapper.appendChild(h3);

    const ul = document.createElement("ul");

    pelotaris
      .sort((a,b) => a.Izena.localeCompare(b.Izena))
      .forEach(p => {
        const edadCat = categoriaPorAnio(p.URTEA);
        const li = document.createElement("li");
        li.textContent = p.Izena;
        li.classList.add(claseCategoria(edadCat)); // üëà sombreado por EDAD
        ul.appendChild(li);
      });

    wrapper.appendChild(ul);
    document.getElementById(contenedor).appendChild(wrapper);
  });

  /* ===== ORDENAR GRUPOS ===== */
  document.querySelectorAll(".content").forEach(content => {
    const grupos = Array.from(content.querySelectorAll(".group"));
    grupos.sort((a,b) =>
      ordenCategorias.indexOf(a.dataset.categoria) -
      ordenCategorias.indexOf(b.dataset.categoria)
    );
    grupos.forEach(g => content.appendChild(g));
  });

});
</script>

</body>
</html>
