<!DOCTYPE html>
<html lang="eu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Larraun ‚Äì Kartela</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>

/* ================= BASE ================= */

body{
  margin:0;
  font-family:"Trebuchet MS","Arial Black",system-ui,sans-serif;
  background:#1b4d31;
}

.exportar{
  text-align:center;
  margin:16px;
}

button{
  background:#0d47a1;
  color:#fff;
  border:none;
  padding:12px 20px;
  border-radius:22px;
  font-weight:bold;
  cursor:pointer;
}

/* ================= CARTEL ORIGINAL (INTACTO) ================= */

.cartel{
  position:relative;
  width:900px;
  margin:20px auto;
  padding:22px;
  border-radius:14px;
  overflow:hidden;

  background:#2f6f48; /* verde m√°s realista */
  box-shadow:0 12px 30px rgba(0,0,0,.45);
}

/* textura hormig√≥n */
.cartel::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    repeating-linear-gradient(45deg, rgba(255,255,255,.02) 0 2px, rgba(0,0,0,.02) 2px 4px),
    radial-gradient(circle at 30% 40%, rgba(0,0,0,.15) 0 3px, transparent 4px);
  z-index:0;
}

/* ================= PELOTAZOS DENSOS ================= */

.pelotazos{
  position:absolute;
  inset:0;
  z-index:0;
  pointer-events:none;
}

.pelota{
  position:absolute;
  border-radius:50%;
  background:#000;
}

/* ================= HEADER COLCH√ìN ================= */

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 20px;

  background:#b00000;

  box-shadow:
    inset 0 8px 12px rgba(255,255,255,.35),
    inset 0 -12px 16px rgba(0,0,0,.6);

  position:relative;
  z-index:1;
}

.header img{height:60px}

.header h1{
  color:#fff;
  letter-spacing:3px;
}

/* ================= BLOQUES ================= */

.bloque{
  margin-top:28px;
  position:relative;
  z-index:1;
}

.bloque h2{
  color:#fff;
  text-align:center;
  letter-spacing:2px;
}

/* ================= GRUPOS ================= */

.grupo{
  background:#fff;
  border-radius:10px;
  margin-top:12px;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
}

.grupo-header{
  padding:10px 14px;
  color:#fff;
  font-weight:bold;
  background:#0d47a1;
}

.grupo-header.rojo{
  background:#b00000;
}

/* ================= PARTIDOS ================= */

.linea{
  padding:8px 12px;
  border-top:1px solid #ddd;
  display:flex;
  gap:10px;
  font-weight:900;
}

.zkia{width:30px}
.etxekoa{color:#0d47a1}
.kanpokoa{color:#b71c1c}

.lehiaketa{
  margin-left:auto;
  text-align:right;
}

.fase{
  font-weight:900;
}

/* ================= PATROCINADORES ================= */

.patrocinadores{
  margin-top:40px;
  padding-top:20px;
  border-top:3px solid #000;
  background:#9e9e9e;
  position:relative;
  z-index:1;
}

.logos-grid{
  display:grid;
  grid-template-columns:repeat(10,1fr);
  gap:10px;
}

.logo-item{
  background:#fff;
  padding:6px;
  border-radius:6px;
}

.logo-item img{
  width:100%;
  height:40px;
  object-fit:contain;
}

</style>
</head>

<body>

<div class="exportar">
<button onclick="exportarPaginas()">üì∏ DESKARGATU JPG GUZTIAK</button>
</div>

<div class="cartel" id="kartela">

<div class="pelotazos"></div>

<div class="header">
<img src="/images/logo-larraun.png">
<h1>LARRAUN PILOTA ELKARTEA</h1>
<img src="/images/logo-fnp.png">
</div>

<div id="content"></div>

<div class="patrocinadores">
<div class="logos-grid" id="logos"></div>
</div>

</div>

<script>

/* ================= PELOTAZOS MUY DENSOS ================= */

function generarPelotazos(){
  const cont=document.querySelector(".pelotazos");
  const w=900;
  const h=document.getElementById("kartela").offsetHeight;

  for(let i=0;i<3000;i++){
    const d=document.createElement("div");
    d.className="pelota";
    const s=Math.random()*7+3;

    d.style.width=d.style.height=s+"px";
    d.style.left=Math.random()*w+"px";
    d.style.top=Math.random()*h+"px";
    d.style.opacity=Math.random()*0.1+0.05;

    cont.appendChild(d);
  }
}

/* ================= FASES ================= */

let fases={};
fetch("/data/fases.json").then(r=>r.json()).then(d=>fases=d);

function formatearLehiaketa(t){
  if(!t) return "";
  const k=Object.keys(fases).find(f=>t.toUpperCase().startsWith(f));
  if(!k) return t;
  return `<span class="fase">${k}</span> (${t.slice(k.length).trim()})`;
}

/* ================= EXPORTACI√ìN MULTIP√ÅGINA REAL ================= */

async function exportarPaginas(){

  const original=document.getElementById("kartela");

  const canvas=await html2canvas(original,{scale:2,useCORS:true});

  const A4=3508; // alto A4 a scale 2

  let y=0, n=1;

  while(y<canvas.height){

    const slice=document.createElement("canvas");
    slice.width=canvas.width;
    slice.height=Math.min(A4,canvas.height-y);

    const ctx=slice.getContext("2d");

    ctx.drawImage(canvas,0,y,canvas.width,slice.height,0,0,canvas.width,slice.height);

    const a=document.createElement("a");
    a.download=`kartela_${n++}.jpg`;
    a.href=slice.toDataURL("image/jpeg",0.95);
    a.click();

    y+=A4;
  }
}

/* ================= INIT ================= */

window.addEventListener("load",()=>{
  generarPelotazos();

  /* logos */
  const LOGOS=[ /* TODOS tus logos originales aqu√≠ */
  "aliprox.jpg","arbeondo.jpg","asadorepeleta.jpg","barainhoa.jpg","kotxera.jpg"
  ];

  const logos=document.getElementById("logos");
  LOGOS.forEach(f=>{
    logos.innerHTML+=`<div class="logo-item"><img src="/images/patrocinio/${f}"></div>`;
  });
});

</script>

</body>
</html>
